<!-- Launch Google Maps -->
<% provide :head_tags do %>
<meta name="turbolinks-visit-control" content="reload">
<% unless @mission.addresses.nil? %>
<script>
	document.addEventListener("DOMContentLoaded", function() {
		initMap(
					<% @mission.addresses.each do |address| %>
						<%= "#{address.coordonnee}, " unless address.coordonnee.nil? %>
					<% end %>
				);
		});
</script>
<% end %>
<% end %>

<section class="slice-xl sct-color-1">
	<div class="container">
		<div class="row align-items cols-xs-space cols-sm-space cols-md-space">
			<div class="col-lg-8 ml-lg-auto order-lg-2">
				<div class="px-inline-only-2">
					<h3 class="heading heading-2 strong-500">
						Description :
						<hr class="mt-0 mb-0">
					</h3>

					<p class="text-lg line-height-1_8 mt-4">
						<h5>
							<%= @mission.description %>
						</h5>
					</p>
				</div>

				<div class="px-inline-only-2">
					<h3 class="heading heading-2 strong-500">
						Participants :
						<hr class="mt-0 mb-0">
					</h3>

					<div class="my-4 text-lg line-height-1_8 mt-4">
						<% @mission.members.each do |member| %>
						<%= link_to  "#{member.first_name} #{member.last_name}", member_path(member.id), class: "" %>,
						<% end %>
					</div>
				</div>

				<div class="px-inline-only-2">
					<h3 class="heading heading-2 strong-500">
						<hr class="mt-0 mb-0">
					</h3>
					<div class="" id="map"></div> <!-- Google Map -->
				</div>
			</div>

			<div class="col-lg-4 order-lg-1 border">
				<div class="">
					<div class="progress-wrapper">
						<h4 class="progress-label text-capitalize text-md strong-600">Nom:</h4>
						<h4>
							<%= @mission.name %>
						</h4>
						<hr class="mt-0 mb-0">
					</div>

					<div class="progress-wrapper mt-4">
						<h4 class="progress-label text-capitalize text-md strong-600">Crée par:</h4>
						<h4>
							<%= link_to  "#{@mission.author.first_name}", member_path(@mission.author.id), class:"" %>
						</h4>
						<hr class="mt-0 mb-0">
					</div>

					<% if @mission.due_date %>
					<div class="progress-wrapper mt-4">
						<h4 class="progress-label text-capitalize text-md strong-600">Date Limite:</h4>
						<h4>
							<%=  time_tag(@mission.due_date) %>
						</h4>
					</div>
					<% end %>
					<div class="progress-wrapper mt-4">
						<h4 class="progress-label text-capitalize text-md strong-600">Crée le:</h4>
						<h4>
							<%= time_tag(@mission.created_at) %>
						</h4>
						<hr class="mt-0 mb-0">
					</div>

					<% @mission.addresses.each do |address| %>
					<div class="progress-wrapper mt-4">
						<h4 class="progress-label text-capitalize text-md strong-600">Lieux:</h4>
						<h4>
							<%= address.street_name_1 %>
						</h4>
						<h4>
							<%= address.postal_code %> -
							<%= address.city %>
						</h4>
						<hr class="mt-0 mb-0">
					</div>
					<% end %>
					<div class="progress-wrapper mt-4 d-flex justify-content-between">
					<% if current_member.role == "super_admin" || current_member.role == "admin" || current_member.id == Mission.find(params[:id]).author_id  %>

					<%= link_to 'Supprimer', mission_path(@mission.id), method: :delete, class: "btn btn-danger btn-shadow btn-circle px-4 mb-4 mt-4" %>
					<%= link_to  "Éditer", edit_mission_path(@mission.id), class: "btn btn-base-1 btn-shadow btn-circle px-4 mb-4 mt-4" %>

					<% end %>
					</div>
				</div>
			</div>
		</div>

	</div>
	<div class="row align-items-center pt-5 ml-2">
		<div class="col-6">
			<%= link_to " Retour", missions_path, class: "fas fa-arrow-left" %>
		</div>
	</div>
</section>